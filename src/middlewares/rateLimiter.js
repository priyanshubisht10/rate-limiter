//generic middleware that uses any strategy